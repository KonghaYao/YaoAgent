# ğŸ› ï¸ å‰ç«¯å·¥å…· - FFT

FFT (Frontend Function as Tools) æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·åè®®ï¼Œå®ƒå…è®¸ä½ å°†å‰ç«¯å‡½æ•°æ— ç¼é›†æˆåˆ° LangGraph çš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿä¸­ã€‚é€šè¿‡ FFTï¼Œä½ å¯ä»¥å°†ä»»ä½•å‰ç«¯å‡½æ•°è½¬æ¢ä¸º LangGraph å¯è°ƒç”¨çš„å·¥å…·ï¼Œå®ç°å‰åç«¯çš„å®Œç¾åä½œã€‚å½“å¤§æ¨¡å‹è°ƒç”¨è¿™äº›å·¥å…·æ—¶ï¼Œæ‰§è¡Œç»“æœä¼šè‡ªåŠ¨è¿”å›åˆ° LangGraph åç«¯ï¼Œç¡®ä¿å·¥ä½œæµç¨‹çš„è¿ç»­æ€§ã€‚

> FFT çš„æ ¸å¿ƒå®ç°åŸºäº LangGraph çš„ interrupt å’Œ resume æœºåˆ¶ï¼Œè¿™ä½¿å¾—å‰åç«¯äº¤äº’å˜å¾—å¼‚å¸¸æµç•…ã€‚è¦äº†è§£æ›´å¤šå…³äºè¿™ä¸ªæœºåˆ¶çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® [LangGraph äººæœºäº¤äº’æ–‡æ¡£](https://langchain-ai.github.io/langgraph/concepts/human_in_the_loop/)
> æ³¨æ„ï¼šFFT åŠŸèƒ½éœ€è¦åç«¯æ”¯æŒï¼Œå…·ä½“å®ç°ç»†èŠ‚è¯·å‚è€ƒ [åç«¯å£°æ˜æ–‡æ¡£](./backend-declare)

## ç¼–å†™å‰ç«¯å·¥å…·

ä¸ºäº†ç®€åŒ–ç®¡ç†å’Œç»´æŠ¤ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®å°†å‰ç«¯å·¥å…·å®šä¹‰åœ¨å•ç‹¬çš„ tsx æ–‡ä»¶ä¸­ã€‚è¿™æ ·å¯ä»¥æ›´å¥½åœ°ç»„ç»‡ä»£ç ï¼Œæé«˜å¯ç»´æŠ¤æ€§ã€‚

å‰ç«¯å·¥å…·ä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š

1. **çº¯å‡½æ•°å·¥å…·**ï¼šè¿™ç±»å·¥å…·ä¸éœ€è¦ç”¨æˆ·äº¤äº’ï¼Œä»…ä½œä¸ºæ•°æ®ä¼ é€’çš„æ¡¥æ¢ã€‚
2. **äº¤äº’å¼å·¥å…·**ï¼šè¿™ç±»å·¥å…·å¯ä»¥å±•ç¤ºè‡ªå®šä¹‰ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œè¾“å…¥ã€è¡¨å•å¡«å†™ç­‰äº¤äº’æ“ä½œã€‚

åœ¨åˆå§‹åŒ–èŠå¤©å­˜å‚¨æ—¶ï¼Œä½ å¯ä»¥åŒæ—¶é…ç½®å·¥å…·çš„ä½¿ç”¨ï¼š

```ts
import { createChatStore } from "@langgraph-js/sdk";
export const globalChatStore = createChatStore(
    "agent",
    {
        apiUrl: "http://localhost:8123"
    }
    {
        onInit(client) {
            client.tools.bindTools([
                // å¯ä»¥åœ¨è¿™é‡Œå£°æ˜å·¥å…·
                fileTool, askUserTool
            ]);
        },
    }
);

```

### å®šä¹‰å·¥å…·åŸºæœ¬å‚æ•°

åœ¨å®šä¹‰å·¥å…·æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å…³é”®å‚æ•°ï¼š

- `name`ï¼šå·¥å…·åç§°ï¼Œå»ºè®®ä½¿ç”¨è‹±æ–‡ã€ä¸‹åˆ’çº¿å’Œè¿å­—ç¬¦çš„ç»„åˆã€‚ç”±äºæŸäº›æ¨¡å‹å¯¹ä¸­æ–‡æ”¯æŒæœ‰é™ï¼Œå»ºè®®é¿å…ä½¿ç”¨ä¸­æ–‡ä½œä¸ºå·¥å…·åç§°ã€‚
- `description`ï¼šå·¥å…·æè¿°ï¼Œéœ€è¦è¯¦ç»†è¯´æ˜å·¥å…·çš„åŠŸèƒ½ã€ä½¿ç”¨åœºæ™¯å’Œé™åˆ¶æ¡ä»¶ã€‚
- `parameters`ï¼šå®šä¹‰å·¥å…·çš„è¾“å…¥å‚æ•°ï¼Œè¿™äº›å‚æ•°å°†ä½œä¸º handler å‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚

```js
import { createToolUI ,ToolManager } from "@langgraph-js/sdk";
// æ–‡ä»¶æ“ä½œå·¥å…·
export const fileTool = createToolUI({
    name: "file_operation",
    description: "æ‰§è¡Œæ–‡ä»¶æ“ä½œï¼ŒåŒ…æ‹¬è¯»å–å’Œå†™å…¥",
    parameters: [
        {
            name: "filePath",
            type: "string",
            description: "æ–‡ä»¶çš„å®Œæ•´è·¯å¾„",
        },
    ],
    // åœ¨è¿™é‡Œå¯ä»¥æ¥æ”¶å¤§æ¨¡å‹çš„å…¥å‚ï¼Œè¿”å›ä¸€ä¸ªä¿¡æ¯å¯¹è±¡
    async handler(args) {
        // args æ˜¯æœ‰ç±»å‹æç¤ºçš„
        await new Promise((resolve) => setTimeout(resolve, 3000));
        // ä½ å¯ä»¥è‡ªå®šä¹‰å›å¤çš„æ•°æ®ï¼Œæ ¼å¼å¦‚åŒ openai çš„æ ‡å‡†
        return [{ type: "text", text: "æ‰§è¡Œæ–‡ä»¶æ“ä½œ " + args.filePath }];
    },
});


```

### å‰ç«¯äº’åŠ¨å·¥å…·

å‰ç«¯äº’åŠ¨å·¥å…·æ˜¯ FFT çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå®ƒå…è®¸ä½ åˆ›å»ºéœ€è¦ç”¨æˆ·å‚ä¸çš„äº¤äº’å¼ç•Œé¢ã€‚è¿™ç§å·¥å…·ç‰¹åˆ«é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š

- éœ€è¦ç”¨æˆ·ç¡®è®¤çš„æ“ä½œ
- éœ€è¦ç”¨æˆ·è¾“å…¥æ•°æ®çš„åœºæ™¯
- éœ€è¦å±•ç¤ºå¤æ‚è¡¨å•çš„ç•Œé¢
- éœ€è¦ç”¨æˆ·è¿›è¡Œé€‰æ‹©çš„åœºæ™¯

ä½¿ç”¨å‰ç«¯äº’åŠ¨å·¥å…·æ—¶ï¼Œä½ å¯ä»¥ï¼š

1. é€šè¿‡ `tool.input` è·å–å¤§æ¨¡å‹ä¼ å…¥çš„å‚æ•°
2. ä½¿ç”¨ `tool.state` ç›‘æ§å·¥å…·çš„çŠ¶æ€ï¼ˆ"pending" æˆ– "done"ï¼‰
3. é€šè¿‡ `tool.response()` æ–¹æ³•è¿”å›ç”¨æˆ·è¾“å…¥çš„ç»“æœï¼Œå¹¶ç»§ç»­å¯¹è¯æµç¨‹

```tsx
import { createToolUI, ToolManager, ToolRenderData } from "@langgraph-js/sdk";
export const askUserTool = createToolUI({
    name: "ask_user",
    description: "è¯¢é—®ç”¨æˆ·",
    parameters: [
        {
            name: "question",
            type: "string",
            description: "é—®é¢˜",
        },
    ],
    // è¿™ä¸ªä¼šè®©æ•´ä¸ªç•Œé¢è¿›å…¥loadingçŠ¶æ€ï¼Œç›´åˆ°åœ¨ UI ç•Œé¢ä¸Šè°ƒç”¨ tool.response()
    handler: ToolManager.waitForUIDone,
    // ä½¿ç”¨ render å‡½æ•°æ¥æ¸²æŸ“è‡ªå®šä¹‰ç•Œé¢
    render(tool: ToolRenderData) {
        const data = tool.input || {};
        // åœ¨è¿™é‡Œå®ç°ä½ çš„UIç»„ä»¶
        return (
            <div>
                <div>{data.question}</div>
                <button onClick={() => tool.response("ç”¨æˆ·å›ç­”")}>
                    æäº¤
                </button>
            </div>
        );
    }
});
```
