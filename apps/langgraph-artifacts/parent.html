<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <iframe src="./index.html" show-console style="width: 100%; height: 90vh" border="0" id="iframe"></iframe>
    </body>
    <script type="module">
        import { getIframeAPI } from "./src/parent.js";
        const iframe = document.getElementById("iframe");
        const iframeApi = await getIframeAPI(iframe);
        console.log("iframeApi", iframeApi);
        // 从 hash 中获取路径，默认为 /test/motion.jsx
        const path = location.hash ? location.hash.slice(1) : "/test/motion.jsx";
        const code = await fetch(path).then((res) => res.text());
        try {
            const data = await iframeApi.run(code, path.replace(/^\//, ""), "application/javascript");
            console.log("done", data);
        } catch (e) {
            console.log(e);
        }
    </script>
</html>
